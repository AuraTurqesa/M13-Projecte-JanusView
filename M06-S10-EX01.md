# üìù Ejercicio Validaci√≥n con Form Requests

## üìö BookHaven API ‚Äî Validaci√≥n de entrada de datos

En la sesi√≥n anterior construiste los **controladores y rutas REST** de BookHaven para gestionar libros, rese√±as y categor√≠as.

En esta actividad vas a **mejorar la calidad de la API** a√±adiendo **validaci√≥n de datos** mediante **Form Requests**, separando la l√≥gica de validaci√≥n de los controladores.

---

## üéØ Objetivo general

Al finalizar el ejercicio, tu API BookHaven deber√°:

- Validar correctamente los datos al **crear y actualizar libros**.
- Validar los datos al **crear rese√±as de un libro**.
- Evitar que lleguen a la base de datos:
  - Campos obligatorios vac√≠os.
  - Tipos de datos incorrectos.
  - Valores fuera del dominio esperado.
  - Relaciones con identificadores inexistentes.

La validaci√≥n debe hacerse **exclusivamente mediante Form Requests**.

---

## üìê Parte 1 ‚Äî Form Requests para libros

Crea dos Form Requests para el modelo `Book`:

1. **Creaci√≥n de libros**
2. **Actualizaci√≥n de libros**

### Requisitos de validaci√≥n al crear un libro

El Form Request de creaci√≥n debe validar que:

- El t√≠tulo es obligatorio y tiene una longitud razonable.
- El autor es obligatorio.
- El g√©nero es obligatorio.
- El n√∫mero de p√°ginas es obligatorio y num√©rico.
- El estado del libro solo puede tomar valores v√°lidos del dominio (por ejemplo: available, reading, finished).
- El resumen es opcional.
- El usuario creador del libro existe si se proporciona.
- El usuario que est√° leyendo el libro existe si se proporciona.

---

### Requisitos de validaci√≥n al actualizar un libro

El Form Request de actualizaci√≥n debe:

- Permitir actualizaciones parciales.
- Validar √∫nicamente los campos que llegan en la petici√≥n.
- Aplicar las mismas reglas de dominio que en la creaci√≥n cuando un campo est√° presente.
- No exigir campos que no se est√°n actualizando.

---

## üìê Parte 2 ‚Äî Integraci√≥n de los Form Requests en el controlador de libros

Modifica el controlador de libros para que:

- El m√©todo de creaci√≥n utilice el Form Request de creaci√≥n.
- El m√©todo de actualizaci√≥n utilice el Form Request de actualizaci√≥n.
- El controlador trabaje √∫nicamente con los datos ya validados.

El controlador **no debe contener l√≥gica de validaci√≥n manual**.

---

## üìê Parte 3 ‚Äî Form Request para crear rese√±as de un libro

Crea un Form Request para la creaci√≥n de rese√±as asociadas a un libro.

Debe validar que:

- El contenido de la rese√±a es obligatorio.
- La puntuaci√≥n es obligatoria y num√©rica, dentro de un rango v√°lido.
- El usuario autor de la rese√±a existe.
- El libro al que se asocia la rese√±a existe (v√≠a la ruta).

---

## üìê Parte 4 ‚Äî Integraci√≥n de la validaci√≥n en rese√±as

Modifica el controlador de rese√±as para que:

- El m√©todo de creaci√≥n reciba el Form Request correspondiente.
- Solo se creen rese√±as si los datos cumplen todas las reglas.
- En caso de error, la API devuelva una respuesta de validaci√≥n autom√°tica.

No es necesario a√±adir validaci√≥n en la eliminaci√≥n de rese√±as.

---

## ‚ñ∂Ô∏è Validaci√≥n del ejercicio

Para considerar el ejercicio completado, deber√°s poder mostrar o explicar:

1. **Form Requests**

   - Qu√© Form Requests has creado.
   - Para qu√© acci√≥n se usa cada uno.
   - Qu√© reglas principales de validaci√≥n contiene cada uno.

2. **Libros**

   - Qu√© ocurre si intentas crear un libro con datos incompletos o inv√°lidos.
   - Qu√© ocurre si intentas actualizar solo un campo.
   - C√≥mo se evita que se guarden datos incorrectos.

3. **Rese√±as**

   - Qu√© ocurre si se intenta crear una rese√±a sin contenido o con puntuaci√≥n inv√°lida.
   - C√≥mo se valida la relaci√≥n entre rese√±a, libro y usuario.

4. **Dise√±o**
   - Que los controladores quedan m√°s simples que en la sesi√≥n anterior.
   - Que la validaci√≥n est√° centralizada y no duplicada.
   - Que la API responde con errores claros cuando los datos no son v√°lidos.
